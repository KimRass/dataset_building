# (한국어, 영어) 뉴스 기사 데이터셋 구축
- 한국어와 영어 각각의 뉴스 기사 데이터셋으로부터 완전한 문장만을 선별하여 데이터셋을 구축하는 프로젝트였습니다.
- 완전한 문장인지 여부를 판별하기 위한 방법은 형태소 분리에 기반합니다. 문장을 형태소 단위로 분리했을 때 정해진 규칙을 만족할 경우 완전한 문장이라고 판별했습니다. 
## 한국어
- 형태소 분석 라이브러리는 `khaiii`와 `mecab`을 사용했습니다.
- 첫 번째 유형: 종결어미, 연결어미 또는 명사형전성어미 이후 1개 이하의 다른 품사가 등장한 후 끝나는 문장 (대부분의 완전한 문장)
- 두 번째 유형: '쉼표 → 숫자 → 기타 기호 → 일반명사' 순서로 품사가 등장하고 끝나는 문장 (e.g. "가민, 장중 3% 이상 급락")
## 영어
- 형태소 분석 라이브러리는 `spacy`와 `nltk`를 사용했습니다. (`flair`는 속도가 매우 느려 사용이 어렵다고 판단했습니다.)
- 다음 품사에 해당하는 형태소가 존재하는 문장을 완전한 문장이라고 판별했습니다.
  - "VBD" (동사의 과거형): e.g., "This *was a sentence"
  - "VBP" (동사의 1인칭 형태): e.g., "I *want to go"
  - "VBZ" (동사의 3인칭 단수 현재 형태): e.g., "He *wants to go"
  - "MD" (조동사): e.g., "This *could work"
  - "HVS" (동사의 'have' 형태): e.g., "I *’ve seen the Queen"
- 이때 아래 품사는 완전한 문장으로 판별하는 근거가 될 수 없다고 판단했습니다.
  - "VB" (동사원형): e.g., "I want to *go"
  - "VBG" (현재분사): e.g., "I am *going"
  - "VBN" (과거분사): e.g., "The treasure was *lost"

# 번역 문장 데이터셋 구축
- 문어체와 구어체 각각에 대한 병렬 코퍼스를 구축하는 프로젝트였습니다.
- 출발어: 한국어, 영어 / 도착어: 힌디어, 크메르어, 타갈로그어, 러시아어, 베트남어, 인도네시아어, 태국어
## 문장 정제
- 문장 맨 앞과 맨 뒤의 공백 제거
- 탭, 개행, 다중 공백을 하나의 공백으로 변경
- 쉼표, 작은따옴표, 큰따옴표 표준화 (e.g., "‘" → "'")
- 문장부호 수정 (e.g., "!," → "!", "??" → "?")
- Invisible unicode characters (e.g., "\u00a0" ("NO-BREAK SPACE")) 삭제
## 작은따옴표와 큰따옴표 수정
- 문장 내 작은따옴표와 큰따옴표가 각각 짝수가 되어 짝을 이루는지 기계적으로 체크한 후 그렇지 못한 문장에 대해 수작업 체크
## 출발어에 대한 유사도 체크
- 서로 다른 문장 쌍에 대해 공백, 이모지와 특수문자를 제거한 후 유사도를 측정하여 0.9 이상인 쌍을 제거했습니다.
- 유사도는 "Levenshtein distance"를 기반으로 다음과 같이 정의했습니다. `1 - (2 * levenshtein_distance(str1, str2) / (len(str1) + len(str2)))`
## 코퍼스 체크
- 중복 체크
- 출발어 또는 도착어에 상응하는 문장인지 체크 (`fasttext`와 `langid` 기반)
- 출발어 또는 도착어가 고유 문자를 가진 언어인 경우, 그에 상응하는 문장이 해당 고유 문자를 포함하고 있는지 체크
- 출발어 (또는 고유어)가 고유 문자를 가진 언어인 경우 도착어 (또는 출발어)의 상응하는 문장이 해당 고유 문자를 포함하고 있지 않은지 체크
- 출발어 문장과 도착어 문장이 서로 일치하지 않은지 체크
- 출발어 문장과 도착어 문장의 길이의 비율이 너무 크거나 작지 않은지 체크
- 출발어 또는 도착어에 따라 문장이 적절한 문장부호로 끝나는지 체크 (e.g., 크메르어의 경우 "។", "?", "!")
## Human translation과 Machine translation의 유사도 측정
- 출발어 문장에 대한 Human translation 결과가 Machine translation 결과와 유사도가 매우 낮다면, 잘못 번역되었을 가능성이 큽니다.
- Gestalt pattern matching algorithm 사용

# 한국어 어휘 사전 예문 구축
- 공공용어, 전문용어 각각에 대한 한국어 어휘 사전에 활용될 예문을 구축하는 프로젝트였습니다.
## 공공용어
- 공공용어란 지명 (e.g., "각시바위"), 음식 이름 (e.g., "돼지곱창구이"), 도로명 (e.g., "사평대로8길") 등 번역 시 일관성 있게 번역돼야 하는 용어입니다.
## 전문용어
- ["우리말샘"](https://opendict.korean.go.kr/main)의 어휘 사전에는 각 어휘에 대한 띄어쓰기 규칙, 원어, 전문분야 등의 정보가 수록되어 있습니다. (모든 어휘의 수: 3,486,752개)
  |어휘|원어|전문분야|품사|뜻풀이|
  |-|-|-|-|-|
  |가격^가변제|價格可變制|경영|품사 없음|같은 상품을 고객이나 상황에 따라 각각 다른 가격으로 판매하는 마케팅 전략.|
  - "^"는 띄어쓰기를, "-"는 붙여쓰기?를 나타냅니다.
- 전문용어란 '전문분야'가 지정된 어휘를 말하며, 대상 품사는 "명사", "대명사", "의존명사", "품사 없음"로 한정했습니다.
## 띄어쓰기 규칙에 따라 문장 수정
- `kiwipiepy`를 사용한 형태소 분석 기반의 알고리즘을 사용했습니다.
1. 각 어휘에 대해 "variation"을 생성합니다. (e.g., "가격^감시^제도": '|가격감시제도|', '|가격감시| |제도|', '|가격| |감시제도|', '|가격| |감시| |제도|')
2. 문장을 형태소 단위로 분리합니다.
  - "그럼 거기는 다음에 예약해서 가고 오늘은 다른곳 가자." → "|그럼| |거기| |는| |다음| |에| |예약| |하| |어서| |가| |고| |오늘| |은| |다른| |곳| |가| |자| |.|"
3. 위 결과에서 의미있는 형태소만을 남깁니다.
  - 여기서 의미있는 형태소는 다음으로 한정했습니다; 용언(V), 부사(MA), 조사(J), 어미(E), 동사 파생 접미사(XSV), 형용사 파생 접미사(XSA), 웹(W), 종결 부호(SF), 구분 부호(SP), 인용 부호 및 괄호(SS) (가운뎃점 ("·")은 제외했습니다.)
  - "그럼 거기는 다음에 예약해서 가고오늘은 다른곳 가자." → "|거기| |다음| |예약| |오늘| |다른| |곳|"
4. 하나의 어휘에 대해 variation 중 하나가 2번과 3번에서 구한 텍스트에 모두 포함되어 있는 경우, 해당 어휘가 문장에서 등장한다고 판단합니다.
  - 이렇게 하는 이유는, 조사 등 실질적인 의미가 없는 단어와 실질적인 의미를 갖는 단어의 조합에 의해 해당 어휘와 단순히 철자만 동일한 문장을 배제하기 위함입니다.
  - e.g., "그 사람의 행동반경을 파악하고 그 주위를 돌아다니는거야!": "|그|", "|사람|", "|행동|", "|행동| |반경|", "|그|", "|주위|", "|거|"
  - 이때 "|행동| |반경|"이 "|행동|"을 포함하고 있으므로 "|행동|"은 배제합니다.
5. 띄어쓰기 규칙을 반영해 문장을 수정합니다.
  - e.g., "그 사람의 행동반경을 파악하고 그 주위를 돌아다니는거야!" → "그 사람의 행동 반경을 파악하고 그 주위를 돌아다니는거야!")

# 한국어 챗봇 학습용 구어체 대화문 데이터셋 구축
- 한국어 챗봇을 학습시키기 위한 한국어 구어체 문장을 구축하는 프로젝트였습니다.
- 특이점으로는 영화 등에 등장하는 명대사와 명대사의 전후에 들어가 이어지는 문장을 구축한다는 점이었습니다.
- Examples
  |구축 문장 A|명대사|구축 문장 B|
  |-|-|-|
  |피곤하다 보니깐 계속 미루는 습관이 생긴 것 같아.|"나중에"라고 외칠때마다 생의 불꽃은 하나씩 꺼지는 법이랬어.|맞아, 할 일을 미루면 안 되는데.|
  |목표를 위해서 너무 안 쉬고 달렸나봐. 갑자기 뇌가 멈추는 느낌이 들더라고.|가끔은 멈출 줄도 알아야 해.|그러게. 번아웃 오기 전에 적당히 할 걸. 지금이라도 좀 쉬어야겠어.|
## 수작업 최소화
- 기계적으로 체크할 수 있는 부분을 최대한 체크하여 수동으로 문장을 확인하는 데 드는 시간과 노력을 최소하하고자 했습니다. 이를 위해 다음과 같이 유형별로 다르게 표시하여 작업자에게 전달했습니다.
- 이중밑줄
  - 맞춤법 수정 등 문장 수정 발생 (e.g., "꺠닫게 되었달까." → "깨닫게 되었달까.")
  - 특정 단어가 포함된 문장
  - 알파벳이 포함된 이모티콘 (e.g., "T^T")
  - 혐오 표현
- 빨간색 셀
  - 두 문장이 서로 Semantic similarity가 높은 경우 (Cosine similarity 0.75 이상)
- 파란색 폰트
  - 반말을 존댓말로 변환
- 볼드체
  - 명대사의 일부를 인용한 문장
## 명대사의 일부를 인용한 문장
- 명대사에 포함된 단어를 그대로 사용하여 문장을 구성하는 것이 아니라, 그 명대사는 비유적인 표현일 뿐으로 아예 다른 맥락의 문장을 구성해야 하는 것이 고객사의 조건 중 하나였습니다.
- 명대사의 일부를 인용한 문장의 예는 다음과 같습니다.
  - 명대사: "가끔 진지하게 생각해. 내 목숨을 어떤 일에 쓰게 될지." / 다음 문장: "네 목숨은 너의 행복을 위해 써야 해. 그것보다 중요한 건 없어."
  - 명대사: "공부에 흥미를 붙이려면 우선 좋은 점수를 받아야 해." / 다음 문장: "재미가 없는데 재미를 붙이기 위해 공부를 해야 한다니."
- 이를 판별하기 위해 `kiwipiepy`를 사용한 형태소 분리 기반의 알고리즘을 구성했습니다. 자세히 설명하면 다음과 같습니다.
  1. 두 개의 문장을 각각 형태소 단위로 분리합니다. 이때 관심 있는 형태소는 일반명사, 고유명사, 동사 ("하", "되" 제외), 형용사, 어근, 알파벳, 한자, 숫자로 한정합니다.
  2. 두 문장에서 공통으로 등장하는 단어의 개수가 2개 이상이면 서로를 인용한 문장으로 판별합니다.
## Semantic Textual Similarity
- 한국어에 대해 Embedding 성능이 우수한 Sentence BERT 모델을 사용하여 유사도를 계산했습니다.
- e.g., "요즘 너무 지친다. 좀 오랫동안 쉬고 싶어.", "요즘 너무 지쳐서 휴식이 필요한 거 같아."
## 반말 → 존댓말 변환
- 사용한 라이브러리: `kiwipiepy`
- Process: 형태소 분석 → 반말을 만드는 형태소를 존댓말에 해당하는 형태소로 변환 → 분리된 형태소를 합쳐 문장으로 복원
### 형태소 변환
- 형태소와 형태소를 나타내는 태그 사이를 `"ᴥ"` 기호로 연결
- 형태소 + 태그 쌍을 서로 구분하기 위한 기호로 `"|"` 사용
- Examples
  - 부탁드립니다 → 부탁해 (`"|부탁ᴥNNG|드리ᴥVV|ᆸ니다ᴥEF|": "|부탁ᴥNNG|하ᴥXSV|어ᴥEF|"`)
  - 옵니다 → 와 (`"|오ᴥEP|ᆸ니다ᴥEF|": "|어ᴥEF|"`)
  - ~할까요 → ~할까 (`"|ᆯ까요ᴥEF|": "|ᆯ까ᴥEF|"`)
  - 재밌으시네요 → 재밌네 (`"|으시ᴥEP|": "|"`, `"|요ᴥJX|": "|"`)

# 한국어 명령어 발화 데이터셋 구축
- "선풍기 켜줘", "온도 내려" 등의 명령어를 발화한 음성 데이터셋을 구축하는 프로젝트였습니다.
## 조건
- 숨소리, 파열음 등의 잡음 제외
- 발음이 분명해야 함
- 발화 전후의 0.3초 이상의 무음 구간
- 발화 구간의 길이는 1.5초 미만
- 진폭 5,000 이상 20,000 미만
- 고주파수 대역이 녹음되지 않으면 안 됨
## 음성 품질 체크
- 다음 값들을 기준으로 음성 파일의 품질을 체크하여 품질이 떨어지는 음성 파일에 대해서만 한번 더 체크하도록 했습니다.
  - 발화 구간 전 무음 구간의 길이
  - 발화 구간의 전체 길이
  - 발화 구간 후 무음 구간의 길이
  - 오디오 파일 전체 길이에 대한 진폭 20,000 미만인 구간의 길이의 비율
  - 오디오 파일 전체 길이에 대한 진폭 5,000 이상인 구간의 길이의 비율
  - 미녹음된 주파수의 개수
  - 발화 구간의 개수
  - 특정한 알고리즘으로 측정한 Noise 수치
  - Noise가 심한 주파수
  - 기준을 충족하지 못한 조건의 개수
## Audio Features
- ![features](https://i.imgur.com/tXk4ppa.png)
  - 위에서부터 순서대로 Waveform, Spectrogram, Mel-spectrogram입니다.
  - Waveform에서 상단에 각각 발화 구간 전 무음 구간의 길이, 발화 구간의 길이, 발화 구간 후 무음 기간의 길이를 표시했습니다.
  - Amplitude 5,000과 20,000에 대해서 수평선을 표시했습니다.
  - Spectrogram에서 y축의 파란색 표시는 Noise가 심한 주파수를, 빨간색 표시는 녹음되지 않은 주파수를 나타냅니다.
  - Spectrogram과 Mel-spectrogram에서 초록색 수직선은 발화 구간을 나타냅니다.
  - Mel-spectrogram에서 층을 이루는 것은 안정적인 발화를 나타냅니다.
